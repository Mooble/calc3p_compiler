I used the source code written by Tom Niemann as my base.  It is available here: http://epaperpress.com/lexandyacc/index.html
There
